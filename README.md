
# 📊 API Consulta Crédito

Este projeto é uma API Java (Spring Boot) que se conecta a um banco de dados PostgreSQL. Toda a configuração necessária está contida em containers Docker, facilitando o uso sem necessidade de instalações manuais.

---

## ✅ Pré-requisitos

- [Docker](https://www.docker.com/)
- [Docker Compose](https://docs.docker.com/compose/)

---

## 🚀 Como rodar o projeto

### 1. Clone este repositório

```bash
git https://github.com/jvhk/api-consulta-credito.git
cd api-consulta-credito/backend/creditos
```

### 2. Suba os containers com Docker Compose

```bash
docker-compose up --build
```

---

## 🧱 O que acontece ao iniciar?

- O banco PostgreSQL é iniciado no container `postgres_credito`.
- O banco `credito_db` é criado automaticamente.
- A tabela `credito` é criada com o seguinte comando:

```sql
CREATE TABLE credito
(
	id               BIGINT GENERATED BY DEFAULT AS IDENTITY,
	numero_credito   VARCHAR(50)   NOT NULL,
	numero_nfse      VARCHAR(50)   NOT NULL,
	data_constituicao DATE         NOT NULL,
	valor_issqn      DECIMAL(15,2) NOT NULL,
	tipo_credito     VARCHAR(50)   NOT NULL,
	simples_nacional BOOLEAN       NOT NULL,
	aliquota         DECIMAL(5,2)  NOT NULL,
	valor_faturado   DECIMAL(15,2) NOT NULL,
	valor_deducao    DECIMAL(15,2) NOT NULL,
	base_calculo     DECIMAL(15,2) NOT NULL
);
```

- Dados de exemplo são inseridos automaticamente:

```sql
INSERT INTO credito (numero_credito, numero_nfse, data_constituicao, valor_issqn, tipo_credito, simples_nacional, aliquota, valor_faturado, valor_deducao, base_calculo)
VALUES
('123456', '7891011', '2024-02-25', 1500.75, 'ISSQN', true, 5.0, 30000.00, 5000.00, 25000.00),
('789012', '7891011', '2024-02-26', 1200.50, 'ISSQN', false, 4.5, 25000.00, 4000.00, 21000.00),
('654321', '1122334', '2024-01-15', 800.50, 'Outros', true, 3.5, 20000.00, 3000.00, 17000.00);
```

- A aplicação Spring Boot é empacotada e iniciada em `http://localhost:8080/api`.

---

## 🔍 Endpoints da API

A API ficará acessível via:

```
http://localhost:8080/api
```

### Endpoints disponíveis na rota `/creditos`:

| Método | URL                          | Descrição                                     |
|--------|------------------------------|-----------------------------------------------|
| GET    | `/creditos/{numeroNfse}`     | Retorna lista de créditos filtrados pelo número NFSe |
| GET    | `/creditos/credito/{numeroCredito}` | Retorna crédito específico pelo número do crédito  |

Exemplo de uso:

- `GET http://localhost:8080/api/creditos/7891011` — lista créditos pelo número NFSe `7891011`
- `GET http://localhost:8080/api/creditos/credito/123456` — consulta crédito pelo número do crédito `123456`


---

## 🧪 Acesso ao banco de dados

Você pode acessar o banco utilizando alguma ferramenta como **DBeaver**, **pgAdmin** ou terminal via `psql`:

- **Host**: `localhost`
- **Porta**: `5432`
- **Banco**: `credito_db`
- **Usuário**: `postgres`
- **Senha**: `root`

---

## 🧹 Para parar os containers

```bash
docker-compose down
```

---

## 🗂️ Estrutura do projeto relevante

```
.
├── Dockerfile
├── docker-compose.yml
├── db
│   └── init
│       ├── create-db.sql         # Criação da tabela
│       └── insert-values.sql     # Inserts iniciais
├── src/                          # Código da aplicação
├── build.gradle
└── README.md
```

---

## 👤 Autor

Seu Nome  
[LinkedIn](https://www.linkedin.com/in/jvhk/)  
[GitHub](https://github.com/jvhk)

---
